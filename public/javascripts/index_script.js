// Generated by CoffeeScript 1.6.2
var dictSmile, replaceAll, show;

$(function() {
  var dispararMensagem, socket;

  socket = io.connect();
  socket.on('news', function(data) {
    return show(data);
  });
  $("#dialog-conversa").dialog({
    width: 400
  });
  $('#msg').keypress(function(event) {
    if (event.which === 13 && !event.shiftKey) {
      dispararMensagem();
      return event.preventDefault();
    }
  });
  $('#botao-enviar').button({
    icons: {
      primary: "ui-icon-plus"
    }
  }).click(function() {
    return dispararMensagem();
  });
  return dispararMensagem = function() {
    var inputmsg, msg;

    inputmsg = $('#msg');
    msg = inputmsg.val();
    inputmsg.val('');
    return socket.emit('message', {
      mensagem: msg,
      author: $("#autor").val()
    });
  };
});

show = function(data) {
  var item, textoMensagem, _i, _len;

  textoMensagem = data.mensagem;
  for (_i = 0, _len = dictSmile.length; _i < _len; _i++) {
    item = dictSmile[_i];
    textoMensagem = replaceAll(textoMensagem, item.text, item.image);
  }
  textoMensagem = replaceAll(textoMensagem, "\n", "<br />");
  $('#dialog-historico').append("<span>" + data.author + ":<br />&nbsp;&nbsp;" + textoMensagem + "</span><br />");
  return $('#dialog-historico').animate({
    scrollTop: $('#dialog-historico').prop("scrollHeight")
  }, 500);
};

replaceAll = function(string, token, newtoken) {
  while (string.indexOf(token) !== -1) {
    string = string.replace(token, newtoken);
  }
  return string;
};

dictSmile = [];

dictSmile.push({
  text: ":)",
  image: "<img src='/images/emoticons/smile1.gif'>"
});

dictSmile.push({
  text: ":smile:",
  image: "<img src='/images/emoticons/smile2.gif'>"
});

dictSmile.push({
  text: ":D",
  image: "<img src='/images/emoticons/grin.gif'>"
});

dictSmile.push({
  text: ":w00t:",
  image: "<img src='/images/emoticons/w00t.gif'>"
});

dictSmile.push({
  text: ":P",
  image: "<img src='/images/emoticons/tongue.gif'>"
});

dictSmile.push({
  text: ";)",
  image: "<img src='/images/emoticons/wink.gif'>"
});

dictSmile.push({
  text: ":|",
  image: "<img src='/images/emoticons/noexpression.gif'>"
});

dictSmile.push({
  text: ":/",
  image: "<img src='/images/emoticons/confused.gif'>"
});

dictSmile.push({
  text: ":(",
  image: "<img src='/images/emoticons/sad.gif'>"
});

dictSmile.push({
  text: ":'(",
  image: "<img src='/images/emoticons/cry.gif'>"
});

dictSmile.push({
  text: ":O",
  image: "<img src='/images/emoticons/ohmy.gif'>"
});

dictSmile.push({
  text: "zzzz",
  image: "<img src='/images/emoticons/sleeping.gif'>"
});

dictSmile.push({
  text: ":innocent:",
  image: "<img src='/images/emoticons/innocent.gif'>"
});

dictSmile.push({
  text: ":unsure:",
  image: "<img src='/images/emoticons/unsure.gif'>"
});

dictSmile.push({
  text: ":closedeyes:",
  image: "<img src='/images/emoticons/closedeyes.gif'>"
});

dictSmile.push({
  text: ":cool:",
  image: "<img src='/images/emoticons/cool2.gif'>"
});

dictSmile.push({
  text: ":thumbsdown:",
  image: "<img src='/images/emoticons/thumbsdown.gif'>"
});

dictSmile.push({
  text: ":blush:",
  image: "<img src='/images/emoticons/blush.gif'>"
});

dictSmile.push({
  text: ":yes:",
  image: "<img src='/images/emoticons/yes.gif'>"
});

dictSmile.push({
  text: ":no:",
  image: "<img src='/images/emoticons/no.gif'>"
});

dictSmile.push({
  text: ":love:",
  image: "<img src='/images/emoticons/love.gif'>"
});

dictSmile.push({
  text: ":?:",
  image: "<img src='/images/emoticons/question.gif'>"
});

dictSmile.push({
  text: ":!:",
  image: "<img src='/images/emoticons/excl.gif'>"
});

dictSmile.push({
  text: ":idea:",
  image: "<img src='/images/emoticons/idea.gif'>"
});

dictSmile.push({
  text: ":arrow:",
  image: "<img src='/images/emoticons/arrow.gif'>"
});

dictSmile.push({
  text: ":arrow2:",
  image: "<img src='/images/emoticons/arrow2.gif'>"
});

dictSmile.push({
  text: ":hmm:",
  image: "<img src='/images/emoticons/hmm.gif'>"
});

dictSmile.push({
  text: ":hmmm:",
  image: "<img src='/images/emoticons/hmmm.gif'>"
});

dictSmile.push({
  text: ":huh:",
  image: "<img src='/images/emoticons/huh.gif'>"
});

dictSmile.push({
  text: ":rolleyes:",
  image: "<img src='/images/emoticons/rolleyes.gif'>"
});

dictSmile.push({
  text: ":kiss:",
  image: "<img src='/images/emoticons/kiss.gif'>"
});

dictSmile.push({
  text: ":shifty:",
  image: "<img src='/images/emoticons/shifty.gif'>"
});

dictSmile.push({
  text: "flowers",
  image: "<img src='/images/emoticons/0032.gif'>"
});

dictSmile.push({
  text: "suadoo",
  image: "<img src='/images/emoticons/0067.gif'>"
});

dictSmile.push({
  text: "026",
  image: "<img src='/images/emoticons/026.gif'>"
});

dictSmile.push({
  text: "wub",
  image: "<img src='/images/emoticons/0098.gif'>"
});

dictSmile.push({
  text: "hug",
  image: "<img src='/images/emoticons/0035.gif'>"
});
